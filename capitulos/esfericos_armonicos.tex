
\chapter[Esféricos Armónicos]
        {Esféricos Armónicos}
\section{Preliminares}
\subsection{Notación}
Para empezar fijaremos la notación que seguiremos durante el capítulo. Usaremos $d\in\mathds{N}$ para representar la dimensión de un conjunto; en particular, el conjunto $\mathds{R}^d = \{x=(x_1,...,x_d)^T : x_j\in\mathds{R},1 \le j \le d\}$ es el espacio euclídeo de dimensión d con el producto escalar y la norma
$$
(x,y) = \sum_{j=1}^{d} x_jy_j  \qquad |x|=(x,x)^{1/2}  \qquad x,y\in\mathds{R}^d
$$
En $\mathds{R}^d$ usaremos la base canónica
$$
e_1=(1,0,...,0)^T, ..., e_d=(0,0,...,1)^T
$$
y escribiremos $x = \sum_{j=1}^{d} x_je_j, x\in\mathds{R}^d$.
\medskip

Para indicar la dimensión explícitamente usaremos $x_{(d)}$ en lugar de $x$. En tal caso, $x_{(d)} = x_{(d-1)}+x_de_d$ siendo $x_{(d-1)}=(x_1,...,x_{d-1},0)^T$. También usaremos $x_{(d-1)}$ para referirnos al vector (d-1)-dimensional $(x_1,...,x_{d-1},0)^T$.
\medskip

Trabajaremos sobre la esfera unidad $\sphere = \{\xi\in\R : |\xi| = 1\}$. Por simplicidad, llamaremos esfera a $\sphere$.
\begin{defn} Sean $\xi,\eta\in\mathds{S}^{d-1}$, definimos las siguientes distancias:
	\begin{itemize}
		\item La distancia euclídea $|\xi-\eta| = \sqrt{2(1-\xi\eta)}$
		\item La distancia geodésica $\theta(\xi,\eta)=arccos(\xi.\eta)$
	\end{itemize}	
\end{defn}

\begin{rem}Usando que $\frac{2}{\pi} \le sin t \le t,       t\in[0,\pi/2]$ se deduce la siguiente relación entre ambas distancias:
	$$
	\frac{2}{\pi}\theta(\xi,\theta) \le |\xi - \eta| \le \theta(\xi,\eta)
	$$ 
\end{rem}

Para $x =(x_1,...,x_d)$ definimos $x^\alpha = x_1^{\alpha_1}...x_d^{\alpha_d}$. Análogamente,
para el operador gradiente $\triangledown = (\partial_{x_1},...,\partial_{x_d})^T$ definimos
$$
	\triangledown^\alpha = \frac{\partial^{|\alpha|}}{\partial x_1^{\alpha_1}...\partial x_d^{\alpha_d}}
$$
Y finalmente definimos el operador laplaciano como
$$
	\triangle = \triangledown.\triangledown = \sum_{j=1}^{d}(\frac{\partial}{\partial x_j})^2
$$


\begin{defn} Dado $x\in\mathds{(R)^+}$ definimos la función gamma como
	$$
	\Gamma(x) := \int_{0}^{\infty} t^{x-1}e^{-t}dt		
	$$
\end{defn}
\begin{prop}Se verifican las siguientes formulas:
	$$
	\int_{0}^{\infty}  t{x-1}e^{-at^b}dt = b^{-1}a^{-x/b}\Gamma(x/b)  , x,a,b \in \mathds{R}^+
	$$
	
	$$
	\int_{0}^{1} |ln t|^{x-1}dt = \Gamma(x),   x \in \mathds{R}^+
	$$
	
	$$
	\Gamma(x+1) = x \Gamma(x) ,		x\in \mathds{R}^+
	$$
	
	$$
	\Gamma^{(k)}(x) = \int_{0}^{\infty} (ln t)^k t^{x-1} e^{-t} dt,   k\in\mathds{N}_0,x\in\mathds{R}^+
	$$
\end{prop}
\begin{rem}
$\Gamma(1)=1$ y de la tercera fórmula se deduce que $\Gamma(n+1)=n!, n\in\mathds{N}_0$. Es decir, la función $\Gamma$ extiende el operador factorial de los números naturales a los reales positivos.
\end{rem}
\begin{lem} 
	$$
	\Gamma(\frac{1}{2}) = 	\sqrt{\pi}
	$$
	$$
	\Gamma(n+\frac{1}{2})=\frac{(2n)!}{2^{2n}n!} \sqrt{\pi}
	$$
\end{lem}
\begin{defn}Sea $x\in\mathds{R}$ y $n\in\mathds{N}$,el símbolo de Pochhammer se define como
	$$
	(x)_0 = 1, (x)_n=x(x+1)(x+2)...(x+n-1)
	$$
\end{defn}
\begin{prop} Sea $x\in\mathds{R}^+$ entonces
	$$
	(x)_n = \frac{\Gamma(x+n)}{\Gamma(x)}
	$$
\end{prop}

\section{Esféricos Armónicos a partir de Espacios Primitivos.}
Consideramos $\mathds{O}^d$ el conjunto de matrices ortogonales de orden d. Para cualquier $\eta \in \mathds{O}^d$ vector no nulo, $\mathds{O}^d (\eta)= \{ A \in \mathds{O}^d : A\eta = \eta \} $ es el subconjunto de matrices ortogonales que deja el subespacio $span\{\eta\} = \{\alpha \eta : \alpha \in \mathds{R}\}$ invariante.

\begin{defn}
	Sea $f:\mathds{R}^d \to \mathds{C}$ y A$ \in \mathds{R}^{dxd}$, se define $f_A$ como:
	$$
	f_A(x)=f(Ax)   , \forall x \in \mathds{R}^d
	$$
\end{defn}

Consideremos un subespacio $\mathds{V}$ de funciones definidas de $\mathds{R}^d$ a un subconjunto de $\mathds{R}^d$.
\begin{defn}
	Sea $\mathcal{V}$ un subespacio de funciones definidas de $\mathds{R}^d$ a $A \subseteqq \mathds{R}^d$. Se dice que $\mathcal{V}$ es invariante si para  $f \in \mathcal{V}$ y  $A\in\mathds{O}^d$, entonces  $f_A \in \mathcal{V}$.
	Considerando $\mathcal{V}$ un subespacio invariante de un espacio proveniente de un producto escalar se define:
	\begin{itemize}
		\item $\mathcal{V}$ es reducible si  $\mathcal{V} = \mathcal{V}_1 + \mathcal{V}_2$ con $\mathcal{V}_1 \not= \emptyset$, $\mathcal{V}_2 \not= \emptyset$ verificando $\mathcal{V}_1,\mathcal{V}_2$ irreducibles y $\mathcal{V}_1 \perp \mathcal{V}_2$.
		\item $\mathcal{V}$ es irreducible si no es reducible.
		\item $\mathcal{V}$ es primitivo si es invariante e irreducible.
	\end{itemize}
\end{defn}

\begin{prop}\label{prop:1}
Si $f_A=f$ para cualquier $A\in \mathds{O}^d$ entonces f(x) depende de x por medio de |x|, luego f es constante en una esfera de radio arbitrario.
\end{prop}

\begin{proof} Sean $x,y \in \mathds{R}^d$ con |x| = |y|, podemos encontrar una matriz $A \in \mathds{O}^d$ tal que $Ax = y$. Entonces $f(x)=f_A(x)=f(y)$.
	
\end{proof}

\begin{defn}Dado $f:\mathds{R}^d \to \mathds{C}$ se define $span\{f_A : A \in \orto\}$ como el espacio de las series $\sum c_jf_{A_j}$ convergentes con $A_j \in \mathds{O}^d$,$c_j \in \mathds{C}$ 
\end{defn}
De la definición se deduce que $span\{f_A : A \in \mathds{O}^d\}$ es un subespacio de funciones. Además, si $\mathcal{V}$ es un espacio finito dimensional $\mathcal{V} = span\{f_A\}$
\medskip

Introduciremos los espacios de armónicos esféricos de diferentes órdenes como subespacios primitivos de $C(\mathds{S}^{d-1})$. 
\subsection{Espacios de Polinomios Homogéneos.}
Consideramos $\mathcal{H}^d_n$ el espacio de polinomios homogéneos de grado n en d dimensiones. Las funciones son de la forma:
$$
\sum_{|\alpha|=n}a_\alpha x^\alpha, a_\alpha \in \mathds{C}
$$
\begin{example}
	$$
		\mathds{H}^2_2 = \{ a_1x_1^2 + a_2x_1x_2 + a_3x_2^2\} 
   $$
$$		\mathds{H}^2_3 = \{ a_1x_1^3 + a_2x_2^3 + a_3x_1^2x_2 + a_4x_1x_2^2 \}
	$$
\end{example}
\medskip
A continuación vamos a estudiar la dimensión de  $\mathcal{H}^d_n$, llegando a la conclusión de que es un espacio invariante finito dimensional.
Para determinar $dim \mathcal{H}^d_n$ contamos los monomios de grado n, es decir, $x^\alpha$ con $\alpha_i \ge 0$ y verificando $\alpha_1 + \alpha_2 + ... + \alpha_d = n$. Tomamos un conjunto $S=\{1,2,...,n+d-1\}$. Seleccionamos $d-1$ números de dicho conjunto y los llamamos $\beta_i, 1\leq i \leq d-1$. Definimos  $\beta_0 = 0 $ y $\beta_d = n+d$.

Ahora, tomamos $\alpha_i$ como el número elementos de $S$ entre 2 $\beta_i$ consecutivos, es decir, $ \alpha_i =  \beta_i - \beta_{i-1} - 1,  1\leq i \leq d$. Tenemos que $$
\sum_{i=1}^{d} \alpha_i = \sum_{i=1}^{d} \beta_i - \beta_{i-1} - \sum_{i=1}^{d} 1 = \beta_d - d = n+d-d = n
$$
Por tanto tenemos una biyección entre el conjunto de $\alpha_i$ que suman $n$ y el conjunto de $\beta_i$. Finalmente, contamos las distintas elecciones posibles de los $\beta_i$ y tenemos que
$$
dim \mathds{H}^d_n = \begin{pmatrix}
n+d-1 \\
d-1
\end{pmatrix} = \begin{pmatrix}
n+d-1 \\
n
\end{pmatrix}
$$
%Cada $\mathds{H}_n \in \mathds{H}^d_n$ se puede escribir como:
%$$
%	\mathds{H}_n(x) = \sum_{|\alpha| = n } a_\alpha x^\alpha ,   a_\alpha \in \mathds{C}.
%$$
%Para el polinomio $	\mathds{H}_n(x)$ definimos
%$$
%		\mathds{H}_n(\triangledown) = \sum_{|\alpha| = n } a_\alpha \triangledown^\alpha.
%$$
%Dados 2 polinomios cualesquiera $\mathds{H}_n(x)$,
%$$
%\mathds{H}_{n,1}(x) =  \sum_{|\alpha| = n } a_{\alpha,1} x^\alpha ,		\mathds{H}_{n,2}(x) =  \sum_{|\alpha| = n } a_{\alpha,2} x^\alpha   
%$$
%Se sigue que 
%$$
%%cosas raras
%$$
%Luego $(\mathds{H}_{n,1},\mathds{H}_{n,2})_{\mathds{H}_n^d} := \mathds{H}_{n,1}(\triangledown)\overline{\mathds{H}_{n,2}(x)}$ define un producto escalar en $\mathds{H}_n^d$
\begin{defn}
Una función f es armónica si $\triangle f (x) = 0$. 
\end{defn}
\begin{lem}
	Si $\triangle f = 0$, entonces $\triangle f_A = 0, \quad \forall A \in \mathds{O}^d$
\end{lem}
\begin{proof}
	Sea $ y = Ax$, entonces $\triangledown_x = A \triangledown_y$. Como $ A \in \mathds{O}^d$ se tiene que 
	$$
	\triangle_x = \triangledown_x . \triangledown_x = \triangledown_y . \triangledown_y = \triangle_y
	$$ 
\end{proof}
A continuación, vamos a ver un subespacio de $H^d_n$ importante.
\begin{defn}
Llamamos $\mathds{Y}_n(\mathds{R}^d)$ al espacio de los polinomios homogéneos de grado n en $\mathds{R}^d$ que son armónicos.
\end{defn}
\begin{example}
$\mathds{Y}_n(\mathds{R}^d) = \mathds{H}^d_n$ si n = 0 o n = 1\\
Para d = 1, $\mathds{Y}_n(\mathds{R})=\emptyset$ para $n\ge 2$\\
Para d = 2, $\mathds{Y}_n(\mathds{R}^2)$, los polinomios de la forma $(x_1 + ix_2) ^n$ pertenecen a $\mathds{Y}_n(\mathds{R}^2).$ En particular,  $\mathds{Y}_2(\mathds{R}^2)$ está formado por polinomios de la forma $a(x_1^2-x_2^2)+bx_1x_2, \qquad	a,b\in\mathds{C}$
\end{example} 
Calculamos ahora la dimensión de $\mathds{Y}_n(\mathds{R}^d)$. Llamaremos $N_{n,d}$ a la dimensión de $\mathds{Y}_n(\mathds{R}^d)$.
Sea $H_{n}\in\mathds{H}_n^d$, dicho polinomio puede ser escrito de la forma
$$
H_n(x_1,...,x_d) = \sum_{j=0}^{n}(x_d)^jh_{n-j}(x_1,...x_{d-1}),		h_{n-j}\in\mathds{H}_{n-j}^{d-1}
$$
Aplicamos el operador laplaciano a $H_n$,
$$
\triangle_{(d)}H_n(x_{(d)}) = \sum_{j=0}^{n-2}(x_d)^j[\triangle_{(d-1)}h_{n-j}(x_{(d-1)})+(j+2)(j+1)h_{n-j-2}(x_{(d-1)})]
$$
Luego, si $H_n \in \mathds{Y}_n(\mathds{R}^d) $ entonces $\triangle_{(d)}H_n(x_{(d)}) \equiv 0$ y
$$
h_{n-j-2} = -\frac{1}{(j+2)(j+1)}\triangle_{(d-1)}h_{n-j},		0 \le j \le n-2
$$
En consecuencia un armónico homogéneo está únicamente determinado por $h_n \in \mathds{H}_n^{d-1}$ y $h_{n-1} \in \mathds{H}_{n-1}^{d-2}$. De este modo, obtenemos la siguiente relación
$$
N_{n,d} = dim \mathds{H}_n^{d-1}+  \mathds{H}_{n-1}^{d-1}
$$
Usando la formula obtenida para $dim \mathds{H}_n^d$ se tiene que para $d\ge 2$,
$$
N_{n,d} = \frac{(2n+d-2)(n+d-3)!}{n!(d-2!)},	n\in\mathds{N}
$$
\subsection{Armónicos de Legendre y Polinomios de Legendre}
Ahora, nos centraremos en unos armónicos homogéneos especiales, los armónicos de Legendre de grado n en d dimensiones.
\begin{defn}
	Se define los armónicos de Legendre, $L_{n,d}:\mathds{R^d}\to\mathds{R}$ verificando las siguientes condiciones:
	\begin{itemize}
		\item $L_{n,d} \in \mathds{Y}_n(\mathds{R}^d)$ 
		\item $L_{n,d}(Ax) = L_{n,d}(x) \qquad  \forall A \in \orto(e_d), \forall x \in \mathds{R}^d$ 
		\item $L_{n,d}(e_d) = 1$
	\end{itemize}
\end{defn}
\begin{rem}
La segunda condición implica que $h_{n-j}(A_1x_{d-1})=h_{n-j}(x_{d-1}), \forall A_1\in \mathds{O}^{(d-1)},\quad x_{(d-1)}\in\mathds{R}^{d-1}, \quad 0\le j\le n$
\end{rem}
De la proposición \hyperref[]{\ref*{prop:1} }
se deduce que por ser $h_{n-j}$ polinomio homogéneo,$(n-j)$ es par y 
\begin{equation}
h_{n-j}(x_{(d-1)}) = \left\lbrace
\begin{array}{ll}
c_k|x_{(d-1)}|^{2k} & \textup{si } n-j=2k \\
0 & \textup{si } n-j=2k+1
\end{array}
\right.
\end{equation}
Por tanto,
$$
L_{n,d}(x) = \sum_{k=0}^{[n/2]} c_k|x_{(d-1)}|^{2k}(x_d)^{n-2k}
$$
Determinamos ahora los coeficientes $c_k$
$$
c_k = - \frac{(n-2k+2)(n-2k+1)}{2k(2k+d-3)}c_{k-1}, \qquad 1\le k \le [n/2]
$$
Usando la condición de normalidad se tiene que $c_0 = 1$ y $$
c_k = (-1)^k \frac{n!\Gamma(\frac{d-1}{2})}{4^kk!(n-2k)!\Gamma(k+\frac{d-1}{2})}, \qquad 0\le k \le [n/2]
$$
Finalmente, obtenemos la siguiente expresión 
$$
L_{n,d}(x) = n!\Gamma(\frac{d-1}{2})\sum_{k=0}^{[n/2]}(-1)^k\frac{|x_{(d-1)|^{2k}}(x_d)^{n-2k}}{4^kk!(n-2k)!\Gamma(k+\frac{d-1}{2})}
$$
Usando coordenadas polares $x_{(d)}=r\xi_{(d)},\xi_{(d)} = te_d+\sqrt{1-t^2}\xi_{(d-1)}$, definimos el polinomio de Legendre de grado n en d dimensiones, $P_{n,d}(t) = L_{n,d}(\xi_{(d)})$ como la restricción a la esfera unidad del armónico de Legendre. Por tanto $$
P_{n,d}(t)=n!\Gamma(\frac{d-1}{2})\sum_{k=0}^{[n/2]}(-1)^k\frac{(1-t^2)^{k}t^{n-2k}}{4^kk!(n-2k)!\Gamma(k+\frac{d-1}{2})}
$$
\begin{rem}
$P_{n,d}(1)=1$ y $L_{n,d}(x) = L_{n,d}(r\xi_{(d)}) = r^nP_{n,d}(t)$
\end{rem}
\subsection{Esféricos Armónicos}
\begin{defn}
Se llama espacio de esféricos armónicos de orden n en d dimensiones a	$\mathds{Y}^d_n = \mathds{Y}_n(\mathds{R}^d)_{|\mathds{S}^{d-1}}$ 
\end{defn}
De la definición se deduce que un esférico armónico $\mathds{Y}_n \in \mathds{Y}^d_n$ está asociado a un armónico homogéneo $\mathds{H}_n \in \mathds{Y}^d_n$ de la siguiente forma:
$$
\mathds{H}_n(r\xi) = r^n\mathds{Y}_n(\xi)
$$
En consecuencia, $dim \mathds{Y}^d_n= N_{n,d}$
\begin{thm}\label{thm:1}Sea $\mathds{Y}^d \in \mathds{Y}^d_n$ y $\xi\in\mathds{S}^{d-1}$. Entonces $\mathds{Y}_n$ es invariante respecto a $\mathds{O}^d(\xi)$, si y sólo si, $\mathds{Y}_n(\eta)=\mathds{Y}_n(\xi)\mathds{P}_{n,d}(\xi.\eta)    \forall \eta\in\mathds{S}^{d-1}$
\end{thm}
\begin{proof}
$(\Rightarrow)$ Dado que $\xi$ es un vector unitario podemos encontrar $A_1 \mathds{O}^d$ tal que $\xi = A_1e_d$. Sea $\overset{~}{Y_n(\eta)} = Y_n(A_1\eta),\eta\in\sphere{d-1}$, que es invariante respecto a $\orto(e_d)$. De la definición de armónico de Legendre sabemos que $r^n\overset{~}{Y_n(\eta)} = c_1L_{n_d}(r^n\eta), r\ge0, \eta\in\sphere$ con $c_1$ una constante.
\medskip

Por tanto, $\overset{~}{Y_n(\eta)} = c_1 L_{n,d}(\eta)$ y tomando $\eta = e_d$ tenemos que $c_1 = \overset{~}{Y_n(e_d)}$.

\medskip
Finalmente como 
$$
\overset{~}{Y_n(\eta)} = \overset{~}{Y_n(e_d)}\mathds{P}_{n,d}(\eta.e_d)
$$
se tiene que
$$
\mathds{Y}_n(\eta)=\overset{~}{Y_n(A_1^T\eta)}=Y_n(A_1^T\eta)\mathds{P}_{n,d}(A_1^T\eta.e_d)=Y_n(A_1^T\eta)\mathds{P}_{n,d}(\eta.A_1e_d) = \mathds{Y}_n(\xi)\mathds{P}_{n,d}(\xi.\eta)
$$
$(\Leftarrow)$ Obvio
\end{proof}

\section{Teorema de Adición. Consecuencias.}
\begin{thm}
Sea $\{Y_{n,j}:1\le j \le N_{n,d}\}$ una base ortonormal de $\spharm$, es decir,
$$
\int_{\mathds{S}^{d-1}} Y_{n,j}(\eta)\overline{Y_{n,j}(\eta)} d\mathds{S}^{d-1} = \delta_{j,k},\qquad	1 \le j,k \le N_{n,d}
$$
Entonces, 
$$
\sum_{j=1}^{N_{n,d}}Y_{n,j}(\xi)\overline{Y_{n,j}(\eta)} = \frac{N_{n,d}}{|\mathds{S}^{d-1}|}P_{n,d}(\xi.\eta)		\forall \xi,\eta \in \mathds{S}^{d-1}
$$

\end{thm}
\begin{proof}Sean $A\in\orto$ y $1\le k \le N_{n,d}$, $Y_{n,k}(A\xi)\in \spharm$ podemos escribir
$$
Y_{n,k}(A\xi) = \sum_{j=1}^{N_{n,d}} c_{kj}Y_{n,j}(\xi), \qquad  c_{kj}\in\mathds{C}
$$
Como $$
\int_{\sphere} Y_{n,k}(A\xi) \overline{Y_{n,k}(A\xi) } d\sphere(\xi) = \int_{\sphere} Y_{n,k}(\eta) \overline{Y_{n,k}(A\eta) } d\sphere(\eta) =\delta_{j,k}
$$
tenemos que 
$$
\delta_{jk} = \sum_{l,m = 1}^{N_{n,d}} c_{j,l}\overline{c_{k,m}}(Y_{n,l},Y_{n,m}) = \sum_{l,m = 1}^{N_{n,d}} c_{j,l}\overline{c_{k,l}}
$$
Sea $C=(c_{j,l})$ y $C^H$ su matriz conjugada transpuesta. Se verifica que $CC^H=I$ y $C^HC=I$ luego C es unitaria y
$$
\sum_{j=1}^{N_{n,d}} \overline{c_{jl}}c_{jk} = \delta_{lk} \qquad 1\le l,k \le N_{n,d}
$$
Ahora, consideramos la suma
$$
Y(\xi,\eta) = \sum_{j=1}^{N_{n,d}} Y_{n,j}(\xi)\overline{ Y_{n,j}(\eta)} ,\quad \xi,\eta\in\sphere
$$
Para $A\in\orto$ y fijado $\xi$ se tiene que
$$
Y(A\xi,A\eta) = \sum_{j=1}^{N_{n,d}} Y_{n,j}(A\xi)\overline{ Y_{n,j}(A\eta)} = \sum_{j,k,l=1}^{N_{n,d}} c_{jk}\overline{c_{jl}} Y_{n,k}(\xi)\overline{ Y_{n,l}(\eta)} = \sum_{j=1}^{N_{n,d}} Y_{n,k}(\xi)\overline{ Y_{n,k}(\eta)} = Y(\xi,\eta)
$$
luego $Y(\xi,.)\in\spharm$ es invariante respecto a $\orto(\xi)$. Por el teorema \ref{thm:1} $Y(\xi,\eta)=Y(\xi,\xi)P_{n,d}(\xi.\eta)$. Análogamente, $Y(\xi,\eta)=Y(\eta,\eta)P_{n,d}(\xi.\eta)$. En consecuencia, $Y(\xi,\xi) = Y(\eta,\eta)$ y es una constante en $\sphere$. Para determinar dicha constante, integramos la igualdad  $Y(\xi,\xi) =  \sum_{j=1}^{N_{n,d}} |Y_{n,j}(\xi)|^2 $ sobre la esfera, obteniendo que
$$
Y(\xi,\xi)|\sphere| =  \sum_{j=1}^{N_{n,d}}\int_{\sphere} |Y_{n,j}(\xi)|^2 d\sphere = N_{n,d}
$$
Por tanto, $Y(\xi,\xi)=\frac{N_{n,d}}{|\sphere|}$ y se cumple $\sum_{j=1}^{N_{n,d}}Y_{n,j}(\xi)\overline{Y_{n,j}(\eta)}= Y(\xi,\eta)=Y(\xi,\xi)P_{n,d}(\xi.\eta) = \frac{N_{n,d}}{|\mathds{S}^{d-1}|}P_{n,d}(\xi.\eta)	$
\end{proof}
\medskip 

Veamos ahora algunas aplicaciones del teorema de adición. En primer lugar, aplicaremos el teorema para encontrar una expresión reducida del kernel de $\spharm$.
\medskip

Cada $Y_n \in \spharm$ puede escribirse de la forma
$$Y_n(\xi) = \sum_{j=1}^{N_{n,d}} (Y_n,Y_{n,j})_{\sphere} Y_{n,j}(\xi)$$
Aplicando el teorema,
$$Y_(\xi)=\int_{\sphere} Y_n(\eta)\sum_{j=1}^{N_{n,d}}Y_{n,j}(\xi)\overline{Y_{n,j}(\eta)}d\sphere(\eta) = \frac{N_{n,d}}{|\sphere|}\int_{\sphere}P_{n,d}(\xi.\eta)Y_n(\eta)d\sphere(\eta)$$
Por tanto, $$
K_{n,d}(\xi.\eta)P_{n,d}(\xi.\eta)
$$
es el kernel "reproducing" de $\spharm$, es decir, $$
Y_n(\xi) = (Y_n,K_{n,d}(\xi,\cdot))_{\sphere} \qquad \forall Y_n \in \spharm, \xi \in \sphere$$
Definimos $\mathds{Y}_{0:m}^d = \underset{n=0}{\overset{m}{\oplus}} \spharm$ como el espacio de todos los esfericos armónicos de orden menor o igual a m. Entonces 
$${K}_{0:m,d}(\xi,\eta) = \frac{1}{|\sphere|}\sum_{n=0}^{m}N_{n,d}P_{n,d}(\xi.\eta)$$ es el "reproducing kernel" de  $\mathds{Y}_{0:m}^d$.
\medskip

A continuación, obtendremos límites para los esféricos armónicos y los polinomios de Legendre.
\begin{prop}
	\begin{gather}
		||Y_n||_\infty \le \left(\frac{N_{n,d}}{|\sphere|}\right)^{\frac{1}{2}}||Y_n||_{L^2(\sphere)} \\
		|P_{n,d}(t)| \le 1 = P_{n,d}(1)
	\end{gather}
\end{prop}
\begin{proof}Tomando $\xi \in \sphere$ por el teorema de adición $$
	\sum_{j=1}^{N_{n,d}} |Y_{n,j}(\xi)|^2 = \frac{N_{n,d}}{|\sphere|} P_{n,d}(||\xi||^2) = \frac{N_{n,d}}{|\sphere|}$$
\end{proof}
\begin{prop}
	$$\sphint |P_{n,d}(\xi.\eta)|^2 dS^{d-1}(\eta) = \frac{|\sphere|}{N_{n,d}}
	$$
\end{prop}
\begin{proof}

	\begin{gather*}
		\begin{aligned}
	\sphint |P_{n,d}(\xi.\eta)|^2 dS^{d-1}(\eta) &= \\ (\frac{|\sphere|}{N_{n,d}})^2 \sphint |\sum_{j=1}^{N_{n,d}} Y_{n,j}(\xi)\overline{Y_{n,j}(\eta)}|^2 dS^{d-1}(\eta)  &=\\  (\frac{|\sphere|}{N_{n,d}})^2 \sum_{j=1}^{N_{n,d}} |Y_{n,j}(\xi)|^2 &= \frac{|\sphere|}{N_{n,d}}
	\end{aligned}
	\end{gather*}	
	
	
	
\end{proof}
\begin{thm}Para cualquier $n\in\mathds{N}_0$ y $d\in\mathds{N}$ el espacio $\spharm$ es irreducible
\end{thm}
\begin{proof}
Razonamos por deducción al absurdo. Supongamos que $\spharm$ es reducible entonces $\exists V_1,V_2$ no vacíos, verificando que $\spharm = V_1 + V_2$ y $V_1 \perp V_2$. Tomamos una base ortonormal de $\spharm$ tal que las primeras $N_1$ funciones recubren $V_1$ y las restantes $N_2 = N_{n,d} - N_1$ recubren  $V_2$. Podemos aplicar el teorema de adición a $V_1$ y $V_2$ con las funciones de Legendre $P_{n,d,1}$ y $P_{n,d,2}$.
\medskip

Como $V_1 \perp V_2$ 
\begin{equation}\label{eq:1}
\int_{\sphere} P_{n,d,1}(\xi\eta)P_{n,d,2}(\xi\eta)d\sphere(\eta) = 0 \qquad \forall\xi\in\sphere
\end{equation}

Fijamos $\xi\in\sphere$ y sea $\phi$ una función tal que $\phi(\eta) = P_{n,d,1}(\xi.\eta)$. Tomamos $A\in\orto(\xi)$ y se cumple que $A^T\xi= \xi$. Entonces
$$P_{n,d,1}(\xi.A.\eta) = P_{n,d,1}(A^T\xi.\eta)=P_{n,d,1}(\xi.\eta)
$$
es decir, $\phi$ es invariante respecto a $\orto(\xi)$. Por el teorema \hyperref[]{\ref{thm:1}}
$$
P_{n,d,1}(\xi.\eta) = P_{n,d,1}(\xi.\xi).P_{n,d}(\xi.\eta) = P_{n,d}(\xi.\eta)
$$
Razonando de forma análoga para $P_{n,d,2}$ se tiene que
$$
P_{n,d,2}(\xi.\eta) = P_{n,d}(\xi.\eta)
$$
Sin embargo, tenemos que 
$$ 0=\int_{\sphere}P_{n,d,1}(\xi\eta)P_{n,d,2}(\xi\eta)d\sphere(\eta) =\int_{\sphere} |P_{n,d}(\xi\eta)|^2 d\sphere(\eta) = \frac{|\sphere|}{N_{n,d}}
$$
Hemos llegado a una contradicción, por tanto, $\spharm$ es irreducible
\end{proof}
\section{Un Operador de Proyección}
Buscamos la mejor aproximación de una función $f\in L^2(\sphere)$ en $\spharm$, es decir, $inf\{||f-Y_n||_{L^2(\sphere)}: Y_n \in \spharm\}$. Si $\{Y_{n,j} : 1\le j \le N_{n,d}\}$ es una base ortonormal de $\spharm$ entonces la solución es la proyección de f en $\spharm$ que está definido para $f\in L^1(\sphere)$ 
$$ (P_{n,d}f)(\xi) = \sum_{j=1}^{N_{n,d}}(f,Y_{n,f})_{\sphere} Y_{n,j}(\xi)$$


\begin{defn}Se define la proyección de $f\in L^1(\sphere)$ en $\spharm$ como $$
		(P_{n,d}f)(\xi) =\frac{N_{n,d}}{|\sphere|} \int_{\mathds{S}^{d-1}}P_{n,d}(\xi.\eta)f(\eta)d\mathds{S}^{d-1},\qquad \xi\in\sphere
	$$
\end{defn}
\begin{rem}El operador $P_{n,d}$ es lineal
\end{rem}
%mas cosas
\begin{prop}El operador proyección $P_{n,d}$ conmuta con las transformaciones ortogonales, es decir, $P_{n,d}f_A=(P_{n,d}f)_A \quad \forall A\in\orto$
\end{prop}
\begin{proof}
	\begin{gather*}
	\begin{aligned}
	(P_{n,d}f_A) (\xi) &= \frac{N_{n,d}}{|\sphere|} \int_{\sphere}P_{n,d}(\xi.\eta)f(A\eta)d\sphere(\eta) \\&= \frac{N_{n,d}}{|\sphere|} \int_{\sphere}P_{n,d}(A\xi.\zeta)f(\zeta)d\sphere(\zeta) =  
	(P_{n,d}f)_A (\xi)
	\end{aligned}
	\end{gather*}
	
\end{proof}
\begin{cor}Si $\mathds{V}$ es un espacio invariante, entonces $P_{n,d}\mathds{V} = {P_{n,d}f : f\in\mathds{V}}$ es un subespacio invariante de $\spharm$.
\end{cor}
\begin{thm}Si $\mathds{V}$ es un espacio invariante de $C(\sphere)$ entonces o $\mathds{V} \perp \spharm$ o $P_{n,d}$ es una biyección de $\mathds{V}$ sobre $\spharm$. En el último caso, $\mathds{V}=\spharm$
\end{thm}
\begin{proof}
Veamos que si $P_{n,d}:\mathds{V} \to \spharm$ es una biyección entonces $\mathds{V}=\spharm$. Ambos espacios son de dimensión finita y tienen la misma dimensión, $N_{n,d}=dim(\spharm)$. Sea $\{V_j : 1 \le j \le N_{n,d} \}$ una base ortonormal de  $\mathds{V}$. Por ser $\mathds{V}$ primitivo, para cada $A\in\orto$ $$
V_j(A\xi) = \sum_{k=1}^{N_{n,d}}c_{jk}V_k(\xi), \quad c_{jk}\in\mathds{C}$$ siendo la matriz $(c_{jk})$ unitaria. Definimos la función $V(\xi,\eta) = \sum_{k=1}^{N_{n,d}}V_j(\xi)\overline{V_j(\eta)}$
y $V(A\xi,A\eta) = V(\xi,\eta), \quad \forall A \in \orto$.
Dados $\xi,\eta \in \sphere$ podemos encontrar $A\in\orto$ tal que, $A\xi=e_d, A\eta = te_d + (1-t^2)^{\frac{1}{2}}e_{d-1}$ para $t=\xi.\eta$. Entonces $V(\xi,\eta) = V(e_d, te_d + (1-t^2)^{\frac{1}{2}}e_{d-1})$ es una función de $t=\xi\eta$. Llamaremos a esta funcion $P_d(t)$. Fijado $\xi$, el "maping" $\eta \to \overline{P_d(\xi.\eta)}$ es una función en $\mathds{V}$, del mismo modo, fijado $\zeta$ el mapping $\eta \to P_{n,d}(\zeta.\eta)$ es una función en $\spharm$.%fumada gorda%
\end{proof}
\begin{cor}Para $m\neq n$, $\mathds{Y}_m^d \perp \mathds{Y}_n^d$
\end{cor}
\begin{proof}Sean $Y_m \in \mathds{Y}_m^d$ e  $Y_n \in \mathds{Y}_n^d$ restricciones sobre la esfera de  $H_m \in \mathds{Y}_m(\mathds{R}^d)$ y $H_m \in \mathds{Y}_n(\mathds{R}^d)$ respectivamente. Como $\triangle H_m(x) = \triangle H_n(x) = 0$ tenemos que $$
	\int_{||x||< 1}(H_m\triangle H_n-H_n\triangle H_m)dx = 0
	$$
Aplicando la fórmula de Green$$
\int_{\sphere}(H_m \frac{\partial H_n}{\partial r} - H_n \frac{\partial H_m}{\partial r}) d\sphere = 0$$
Además, por ser $H_m$ un polinomio homogéneo de grado m $$
\left.\frac{\partial H_m(x)}{\partial r}\right|_{x=\xi} = m Y_m(\xi),\quad \xi\in\sphere$$
Análogamente,
$$
\left.\frac{\partial H_n(x)}{\partial r}\right|_{x=\xi} = m Y_n(\xi),\quad \xi\in\sphere 
$$
Por tanto, $$
\sphint (n-m)Y_m(\xi)Y_n(\xi)dS^{d-1}(\xi) = 0
$$
Finalmente, como $m\neq n$, $$
\sphint Y_m(\xi)Y_n(\xi)dS^{d-1}(\xi) = 0
$$
\end{proof}
\section{Generando Bases Ortonormales para Espacios de Esféricos Armónicos.}
\begin{prop}Si $Y_{j,d-1}\in\mathds{Y}_j^{d-1}$ entonces $P{n,d,j}(t)Y_{j,d-1}(\xi_{(d-1)})\in\spharm$ en coordenadas polares.
\end{prop}
\begin{defn}
Para $d\ge3$ y $m\le n$ definimos el operador $$
P_{n,m} : \mathds{Y}_m^{d-1} \to \spharm
$$
como
\end{defn}
\begin{thm}Para $d\ge 3$ y $n\ge 0$ se tiene que $$
	\spharm = \mathds{Y}^d_{n,0} \oplus ... \oplus \mathds{Y}^d_{n,n}
$$
\end{thm}
\begin{proof}
En primer lugar,veamos que los subespacios $\mathds{Y}^d_{n,i}$ son ortogonales 2 a 2. Sea $0\le k,m\le n$ con $k \neq m$. Para cualesquiera $\mathds{Y}_{k,d-1}\in\mathds{Y}_k^{d-1},\mathds{Y}_{m,d-1}\in\mathds{Y}_m^{d-1}$, %igualdades guapas
Luego, $\mathds{Y}_{n,k} \perp \mathds{Y}_{n,m}$ para  $k \neq m$.
\end{proof}

\appendix
\chapter{La Función Gamma}\label{aped.A}
\chapter{Resultados básicos de la esfera.}\label{aped.B}
Usaremos $dV^d$ para elemento diferencial de volumen y $dS^{d-1}$ para elemento diferencial de superficie de la esfera.  $\mathds{S^{d-1}}$

\begin{prop}Para $d \ge 3$ y $\xi \in \mathds{S}^{d-1}$,con $\xi_{(d)} = te_d+\sqrt{1-t^2}\xi_{(d-1)},  t\in[-1,1]$ , se tiene que
	$$
	dS^{d-1}(te_d+\sqrt{1-t^2}\xi_{(d-1)}) = (1-t^2)^{\frac{d-3}{2}}dt  dS^{d-2}(\xi_{(d-1)})
	$$
	Equivalentemente,
	$$
	dS^{d-1} = (1-t^2)^{\frac{d-3}{2}}dt dS^{d-2}
	$$
\end{prop}
\begin{example}Sea d=3 y $\xi$ un punto genérico de la esfera. Usando coordenadas esféricas $$
	\xi_{(3)}=\begin{pmatrix}
	cos\phi sen\theta\\
	sen\phi sen\theta\\
	cos\theta\\
	\end{pmatrix}
	0 \le \phi \le 2\pi , 0 \le \theta \le \pi
	$$
	Sea $t=cos\theta$ entonces
	$$
	\xi_{(2)} = \begin{pmatrix}
	cos\phi\\
	sen\phi\\
	0\\
	\end{pmatrix}
	$$
	Por tanto,$ \xi_{(3)} = te_3 + \sqrt{1-t^2} \xi_{(2)}$ y $dS^1 = d\phi , dS^2 = dtd\phi$
	
\end{example}
Podemos usar la anterior proposición para el cálculo del área de la superficie de la esfera.
\begin{prop}Se verifica que
	$$
	|\mathds{S}^{d-1}| = \int_{\mathds{S}^{d-1}} dS^{d-1} = \frac{2\pi^\frac{d}{2}}{\Gamma(\frac{d}{2})}
	$$
\end{prop} 

\begin{prop}
	Sea $A\in\mathds{R}^{dxd}$ ortogonal entonces
	$$ dS^{d-1}(A\xi) =  dS^{d-1}(\xi)$$
	$$ dV^{d}(A\xi) =  dV^{d}(\xi)$$
\end{prop}

Llamamos $C(S^{d-1})$ al espacio de funciones continuas sobre  $S^{d-1}$. Este espacio es un espacio de Banach con la norma $ ||f||_\infty = sup \{ |f(\xi) : \xi\in \mathds{S}^{d-1}\}$. Llamaremos $L^2(S^{d-1})$ al espacio de funciones con cuadrado integrable en $S^{d-1}$. Dicho espacio es un Hilbert con el producto escalar$$ (f,g) = \int_{S^{d-1}} f\overline{g} dS^{d-1}
$$
Consideramos el espacio $C(S^{d-1})$ con la norma inducida por el producto escalar de $L^2(S^{d-1})$. Este espacio no es completo. Además, el cierre de $C(S^{d-1})$ respecto a dicha norma es $L^2(S^{d-1})$. Es decir, dado una función $f\in L^2(S^{d-1})$ existe una sucesión $\{f_n\} \subset C(S^{d-1})$ tal que ${f_n}\to f$

\begin{prop}Sean $\Omega_\delta = \{x\in\mathds{R}^d : |x|\in[1-\delta,1+\delta]\}$ y $f^*(x)= f(\frac{x}{|x|}),x\in\Omega_\delta$ y $k\in\mathds{N}$.Entonces $f$ es k veces diferenciable en $S^{d-1}$ cuando $f^*$ lo es.  
\end{prop}
\begin{defn}Definimos $C^k(S^{d-1}), k\in\mathds{N}\cup0$ como el espacio de funciones k veces diferenciables en $S^{d-1}$
\end{defn}
\begin{prop}$C^k(S^{d-1})$ es un espacio de Banach con la norma 
	$$
	||f||_{C^k(S^{d-1})} = ||f^*||_{C^k(\Sigma_\delta)}
	$$
\end{prop}
\begin{rem}Usaremos $||f||_\infty = ||f||_{C(S^{d-1})}$
	
\end{rem}
\chapter{Polinomios de Legendre}\label{aped.C}


\section{Fórmulas de Representación}
\subsection{Fórmula de Rodrigues}
\begin{thm}
	$$P_{n,d}(t) = (-1)^n \frac{\Gamma(\frac{d-1}{2}) }{2^n\Gamma(n+\frac{d-1}{2})}(1-t^2)^{\frac{3-d}{2}}(\frac{d}{dt})^n (1-t^2)^{n+\frac{d-3}{2}}, \quad d\ge2
	$$
\end{thm}
\begin{rem}\label{cte_Rod}
	A la constante $R_{n,d} = \frac{\Gamma(\frac{d-1}{2})}{2^n\Gamma(n+\frac{d-1}{2})}$ se le llama constante de Rodrigues
\end{rem}
\begin{example}
	\begin{itemize}
		\item Si d = 2, $$P_{n,2}(t) = (-1)^n \frac{2^n n!} {(2n)!}(1-t^2)^{\frac{1}{2}}(\frac{d}{dt})^n (1-t^2)^{n-\frac{1}{2}}, \quad n\in \mathds{N}_0$$ Una forma reducida se obtiene usando el polinomio de Chebyshev obteniendo que $P_{n,2}(t) = cos(n arccos t), t\in[-1,1]$
		\item Si d=3, $$P_{n,3}(t) = \frac{1} {2^n n!}(\frac{d}{dt})^n (t^2-1)^{n}, \quad n\in \mathds{N}_0$$
	\end{itemize}
\end{example}
\subsection{Fórmulas de Representación Integral.}
\begin{thm}Sea $n\in\mathds{N}_0$ y $d\ge3$, $$ 
	P_{n,d}(t) = \frac{|\mathds{S}^{d-3}|}{|\mathds{S}^{d-2}|}\int_{-1}^{1}[t+i(1-t^2)^{\frac{1}{2}}s]^n(1-s^2)^{\frac{d-4}{2}} ds, \quad t\in[-1,1]
	$$
\end{thm}
\begin{rem}Como consecuencia de la fórmula anterior se tiene que $P_{n,d}(-t) = (-1)^n P_{n,d}(t), t\in[-1,1]$, es decir $P_{n,d}(t)$ tiene la misma paridad que $n$.
\end{rem}
Podemos obtener otra fórmula de representación integral, usando funciones trigonométricas mediante el cambio de variable $s = tanh u, u\in\mathds{R}$
\begin{thm}Sea $n\in\mathds{N}_0$ y $d\ge3$, $$
		P_{n,d}(t) = \frac{|\mathds{S}^{d-3}|}{|\mathds{S}^{d-2}|}\int_{-1}^{1}\frac{(1-s^2)^{\frac{d-4}{2}}}{[t\pm i(1-t^2)^{\frac{1}{2}}s]^{n+d-2}} ds, \quad t\in(0,1]
	$$
\end{thm}
\section{Propiedades}
\begin{prop}
Si $f\in C^n([-1,1])$ entonces 
$$
\int_{-1}^{1} f(t)P_{n,d}(t)(1-t^2)^{\frac{d-3}{2}} dt = R_{n,d}\int_{-1}^{1} f^{(n)}(t)(1-t^2)^{n+\frac{d-3}{2}} dt
$$
siendo $R_{n,d}$ la constante de Rodrigues \hyperref[]{(Nota \ref{cte_Rod})}
\end{prop}
\begin{prop}$P_{n,d}(t)$ tiene n raíces distintas en (-1,1)
\end{prop}
\begin{prop}Los polinomios de Legendre satisfacen la siguiente relación de recurrencia
	\begin{gather*}
		P_{n,d}(t) = \frac{2n+d-4}{n+d-3}t	P_{n-1,d}(t) - \frac{n-1}{n+d-3}P_{n-2,d}(t), \qquad n\ge 2, d\ge2 \\
		P_{0,d}(t) = 1 , 	P_{1,d}(t) = t 
	\end{gather*}
\end{prop}
\begin{prop}
	\begin{gather*}
	(1-t^2)P'_{n,d}(t) = n[P_{n-1,d}(t)-tP_{n,d}(t)], \quad n \ge 1,d \ge 2, t \in [-1,1]
	\end{gather*}
\end{prop}
\begin{prop}Para $d\ge 2$
$$\sum_{n=0}^{\infty} N_{n,d}r^nP_{n,d}(t) = \frac{1-r^2}{(1+r^2-2rt)^\frac{d}{2}},\quad |r| < 1, t\in[-1,1] 
$$
\end{prop}
\begin{prop}
	\begin{gather*}
	P_{n,d}(0) = \frac{|\mathds{S}^{d-3}|}{|\mathds{S}^{d-2}|}\int_{-1}^{1} i^n s^n(1-s^2)^{\frac{d-4}{2}}ds \\
	P_{n,d}(-1) = (-1)^n
	\end{gather*}
\end{prop}
\begin{prop}
	$$
	|P_{n,d}(t)| < \frac{\Gamma(\frac{d-1}{2})}{\sqrt{\pi}}\left[\frac{4}{n(1-t^2)}\right]^{\frac{d-2}{2}},\quad n\in\mathds{N}_0,d\ge2,t\in(-1,1)$$
\end{prop}

\chapter{Polinomios de Gegenbauer}\label{aped.D}
\begin{defn}Sean $v\ge 0,n\in\mathds{N}_0$ se define el polinomio de Gegenbauer de grado n e índice v, como:
	$$C_{n,v}(t) = \binom{n+2v-1}{n}\frac{\Gamma(v+\frac{1}{2})}{\sqrt{\pi}\Gamma(v)}\int_{-1}^{1}\left[t+i(1-t^2)^{1/2}s\right]^n (1-s^2)^{v-1} ds$$ 
\end{defn}
\begin{prop}(Identidad de Gegenbauer.)$$
	\sum_{n=0}^{\infty} C_{n,v}(t) = \frac{1}{(1+r^2-2rt)^v}, \qquad |r|<1, t\in[-1,1]$$
\end{prop}